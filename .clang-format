# clang-format configuration for embedded C project
# Based on Google style with customizations for embedded development

# 基于Google代码风格
BasedOnStyle: Google

# 基本格式设置
IndentWidth: 4
TabWidth: 4
UseTab: Never
ColumnLimit: 80 # 进一步减小列限制，强制触发换行

# 大括号换行风格
BreakBeforeBraces: Attach

# 函数和语句格式
AllowShortFunctionsOnASingleLine: None
AllowShortIfStatementsOnASingleLine: Never
AllowShortLoopsOnASingleLine: false
AllowShortCaseLabelsOnASingleLine: false
AllowShortBlocksOnASingleLine: Never

# 关键设置：函数参数换行
BinPackArguments: false
BinPackParameters: false
BreakConstructorInitializers: BeforeComma
AlignAfterOpenBracket: Align

# 关键设置：强制二元运算符换行（兼容旧版本）
BreakBeforeBinaryOperators: All # 在所有二元运算符前换行
AlignOperands: true # 对齐操作数

# 指针对齐
DerivePointerAlignment: false
PointerAlignment: Left

# 头文件包含
SortIncludes: true
IncludeBlocks: Preserve
IncludeCategories:
  - Regex: '^<.*\.h>'
    Priority: 1
  - Regex: "^<.*"
    Priority: 2
  - Regex: ".*"
    Priority: 3

# 空格设置
SpaceAfterCStyleCast: true
SpaceBeforeParens: ControlStatements
SpaceInEmptyParentheses: false
SpacesInCStyleCastParentheses: false
SpacesInParentheses: false
SpacesInSquareBrackets: false

# 对齐设置
AlignConsecutiveAssignments: true
AlignConsecutiveDeclarations: true
AlignTrailingComments: true

# 换行设置
BreakBeforeTernaryOperators: true
BreakStringLiterals: true

# 缩进设置
IndentCaseLabels: false
IndentGotoLabels: false
IndentPPDirectives: AfterHash
IndentWrappedFunctionNames: false

# 其他设置
KeepEmptyLinesAtTheStartOfBlocks: false
MaxEmptyLinesToKeep: 1
ReflowComments: true
DisableFormat: false
NamespaceIndentation: All
AllowShortEnumsOnASingleLine: false

{
	"version": "2.0.0",
	"tasks": [
		{
			"label": "Configure Project",
			"type": "shell",
			"command": "cmake",
			"args": [
				"-DCMAKE_EXPORT_COMPILE_COMMANDS=ON",
				"-DCMAKE_BUILD_TYPE=Debug",
				"-GNinja",
				"-Bbuild"
			],
			"group": {
				"kind": "build",
				"isDefault": false
			}
		},
		{
			"label": "Build only",
			"type": "shell",
			"command": "cmake",
			"args": [
				"--build",
				"build",
				"--target",
				"all",
				"--",
				"-j12"
			],
			"group": {
				"kind": "build",
				"isDefault": false
			}
		},
		{
			"label": "Generate A2L",
			"type": "shell",
			"options": {
				"shell": {
					"executable": "cmd.exe",
					"args": [
						"/c"
					]
				}
			},
			"command": "",
			"args": [
				"${workspaceFolder}/utils/a2ltool.exe",
				"--create",
				"--elffile",
				"build/${workspaceFolderBasename}.elf",
				"--measurement-regex",
				".*",
				"--a2lversion",
				"1.5.0",
				"--output",
				"build/${workspaceFolderBasename}.a2l",
				"&&",
				"powershell",
				"-File",
				"utils/A2LFilter.ps1",
				"-InputFile",
				"build/${workspaceFolderBasename}.a2l",
				"-OutputFile",
				"build/${workspaceFolderBasename}.a2l"
			],
			"group": {
				"kind": "build",
				"isDefault": false
			},
			"problemMatcher": []
		},
		{
			"label": "Clean ELF",
			"type": "shell",
			"options": {
				"shell": {
					"executable": "cmd.exe",
					"args": [
						"/c"
					]
				}
			},
			"command": "cmd",
			"args": [
				"/c",
				"if",
				"exist",
				"build/${workspaceFolderBasename}.elf",
				"del",
				"/f",
				"build/${workspaceFolderBasename}.elf"
			],
			"problemMatcher": []
		},
		{
			"label": "Build and deploy",
			"dependsOn": [
				"Configure Project",
				"Build only",
				"Generate A2L"
			],
			"dependsOrder": "sequence",
			"group": {
				"kind": "build",
				"isDefault": false
			},
			"problemMatcher": []
		},
		{
			"label": "Flash",
			"type": "shell",
			"options": {
				"shell": {
					"executable": "cmd.exe",
					"args": [
						"/c"
					]
				},
				"cwd": "${workspaceFolder}"
			},
			"command": "JLink.exe -CommanderScript .vscode/flash.jlink",
			"group": {
				"kind": "build",
				"isDefault": false
			}
		}
	]
}